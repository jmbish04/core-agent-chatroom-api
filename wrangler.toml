name = "core-agent-chatroom-api"
main = "src/index.ts"
compatibility_date = "2025-03-07"
compatibility_flags = ["nodejs_compat"]

# Observability
[observability]
enabled = true
head_sampling_rate = 1

# Durable Object bindings
[[durable_objects.bindings]]
name = "CHATROOM"
class_name = "ChatRoom"

[[durable_objects.bindings]]
name = "ROOM_DO"
class_name = "RoomDO"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["ChatRoom"]

[[migrations]]
tag = "v2"
new_classes = ["RoomDO"]


# D1 Database binding
[[d1_databases]]
binding = "DB"
database_name = "core-agent-chatroom-api"
database_id = "0753879d-2d0f-4bdc-9aa1-747566cc118d"
migrations_dir = "migrations"

# Analytics Engine binding (optional, for enhanced logging)
# [[analytics_engine_datasets]]
# binding = "ANALYTICS"

[assets]
directory = "./public"
binding = "ASSETS"

[build]
command = "npm run build"

# Cron trigger for agent monitoring (every 15 minutes)
[triggers]
crons = ["*/15 * * * *"]

